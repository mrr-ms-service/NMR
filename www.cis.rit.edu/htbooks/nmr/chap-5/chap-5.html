<HTML>

<!-- Mirrored from www.cis.rit.edu/htbooks/nmr/chap-5/chap-5.htm by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Jun 2021 07:45:00 GMT -->
<HEAD><TITLE>CHAPTER-5</TITLE></HEAD>
<BODY>
<BODY BGCOLOR="#ffffff">
<CENTER><H1>Основы ЯМР</H1>
<H2>Глава 5</H2>
<H2>ПРЕОБРАЗОВАНИЯ ФУРЬЕ</H2></CENTER>

<HR COLOR="#CC0000">
<H4><UL>
	<LI><A HREF="#5.1">Введение</A>
 	<LI><A HREF="#5.2">Проблема + и - частоты</A>
	<LI><A HREF="#5.3">Преобразование Фурье</A>
	<LI><A HREF="#5.4">Фазовая коррекция</A>
	<LI><A HREF="#5.6">Пары Фурье</A>
	<LI><A HREF="#5.7">Теорема о свертке</A>
	<LI><A HREF="#5.8">Цифровое ПФ</A>
	<LI><A HREF="#5.9">Ошибка выборки</A>
	<LI><A HREF="#5.10">Двумерное ПФ</A>

</UL></H4>
<HR>
<A NAME="5.1"></A><H3>Введение</H3>


Подробное описание преобразования Фурье (ПФ) ждало своего часа, пока вы не поймете, зачем оно нужно. Преобразование Фурье — это операция, которая преобразует функции из временной области в частотную. Обратное преобразование Фурье (ОПФ) преобразует из частотной области во временную. <P>

Вспомним из <A HREF="../chap-2/chap-2.html#2.9" TARGET="TEXT" >Главы 2 </A>, что преобразование Фурье — это математический метод преобразования данных временной области в данные частотной области и наоборот.
<A HREF="../chap-2/b9-1.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A><P>


<A NAME="5.2"></A><H3>Проблема + и - частоты</H3>
Для начала подробного описания преобразования Фурье рассмотрим следующее. Вектор намагниченности, начинающийся с +x, вращается вокруг оси Z по часовой стрелке. График M<FONT SIZE="-1"><SUB>x</SUB></FONT>
как функции времени представляет собой косинусоиду.
<A HREF="e2-1.html" TARGET="ANIMATION"><IMG SRC="../images/play.gif"></A>
Преобразование Фурье дает пики как при +<IMG SRC="../images/10-nu.gif">, так и при -<IMG SRC="../images/10-nu.gif">,
поскольку преобразование Фурье не может отличить +<IMG SRC="../images/10-nu.gif">
и -<IMG SRC="../images/10-nu.gif">
вращение вектора из предоставленных данных.
<A HREF="e2-2.html" TARGET="ANIMATION"><IMG SRC="../images/play.gif"></A><P>

График M<FONT SIZE="-1"><SUB>y</SUB></FONT> как функции времени представляет собой функцию -синуса.
<A HREF="e2-3.html" TARGET="ANIMATION"><IMG SRC="../images/play.gif"></A>  
Преобразование Фурье дает пики при +<IMG SRC="../images/10-nu.gif"> и -<IMG SRC="../images/10-nu.gif">
поскольку FT не может отличить положительный вектор, вращающийся при +<IMG SRC="../images/10-nu.gif">,
от отрицательного вектора, вращающегося при -<IMG SRC="../images/10-nu.gif">,
из предоставленных данных.
<A HREF="e2-4.html" TARGET="ANIMATION"><IMG SRC="../images/play.gif"></A><P>
Решение состоит в том, чтобы ввести в FT как M<FONT SIZE="-1"><SUB>x</SUB></FONT>, так и M<FONT SIZE="-1"><SUB>y</SUB></FONT>. FT разработан для обработки двух ортогональных входных функций, называемых реальной и мнимой компонентами.
<A HREF="e2-5.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A><P>

Обнаружение только компонента M<FONT SIZE="-1"><SUB>x</SUB></FONT> или M<FONT SIZE="-1"><SUB>y</SUB></FONT> для ввода в FT называется линейным обнаружением. Это была схема обнаружения на многих старых ЯМР-спектрометрах и некоторых магнитно-резонансных томографах. Она требовала от компьютера отбрасывать половину данных частотной области.
<A HREF="e2-6.html" TARGET="ANIMATION"><IMG SRC="../images/play.gif"></A><P>

Обнаружение как M<FONT SIZE="-1"><SUB>x</SUB></FONT>, так и M<FONT SIZE="-1"><SUB>y</SUB></FONT>называется квадратурным обнаружением и является методом обнаружения на современных спектрометрах и устройствах формирования изображений. Это метод выбора, поскольку теперь FT может различать
+<IMG SRC="../images/10-nu.gif"> и -<IMG SRC="../images/10-nu.gif">, и все данные частотной области могут быть использованы.
<A HREF="e2-5.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A><P>


<A NAME="5.3"></A> <H3>Преобразование Фурье</H3>
Преобразование Фурье определяется интегралом
<A HREF="../refs/ref-03.html" TARGET="ANIMATION"><IMG SRC="../images/ref.gif"></A> 
<A HREF="../refs/ref-04.html" TARGET="ANIMATION"><IMG SRC="../images/ref.gif"></A><P>
<CENTER><IMG SRC="images/ft_eq_1.gif"></CENTER><P>

Думайте о f(<IMG SRC="../images/10-omega.gif">) как о наложении f(t) с волной частоты
<IMG SRC="../images/10-omega.gif">. <P>

<CENTER><IMG SRC="images/ft_eq_2.gif"></CENTER><P>

Это легко представить, взглянув только на действительную часть <I>f</I>(<IMG SRC="../images/10-omega.gif">). <P>
<CENTER><IMG SRC="images/ft_eq_3.gif"></CENTER><P>

Рассмотрим функцию времени f( t ) = cos( 4t ) + cos( 9t ).
<A HREF="e3-1.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A><P>

Чтобы понять FT, исследуйте произведение f(t) с cos(<IMG SRC="../images/10-omega.gif">t) для
<IMG SRC="../images/10-omega.gif"> значений от 1 до 10, а затем суммирование значений этого произведения от 1 до 10 секунд. Суммирование будет рассматриваться только для значений времени от 0 до 10 секунд.<P>

<CENTER>
<TABLE>
<TR><TD><A HREF="e3-2.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>
		<IMG SRC="../images/10-omega.gif">=1
<TR><TD><A HREF="e3-3.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>

		<IMG SRC="../images/10-omega.gif">=2
<TR><TD><A HREF="e3-4.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>
		<IMG SRC="../images/10-omega.gif">=3
<TR><TD><A HREF="e3-5.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>
		<IMG SRC="../images/10-omega.gif">=4
<TR><TD><A HREF="e3-6.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>
		<IMG SRC="../images/10-omega.gif">=5
<TR><TD><A HREF="e3-7.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>
		<IMG SRC="../images/10-omega.gif">=6
<TR><TD><A HREF="e3-8.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>
		<IMG SRC="../images/10-omega.gif">=7
<TR><TD><A HREF="e3-9.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>
		<IMG SRC="../images/10-omega.gif">=8
<TR><TD><A HREF="e3-10.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>
		<IMG SRC="../images/10-omega.gif">=9
<TR><TD><A HREF="e3-11.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>
		<IMG SRC="../images/10-omega.gif">=10
<TR><TD><A HREF="e3-12.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>
		f(<IMG SRC="../images/10-omega.gif">)
</TABLE>
</CENTER><P>

Обратное преобразование Фурье (ОПФ) лучше всего описать как суммирование спектров частот во временной области в f(<IMG SRC="../images/10-omega.gif">).
<A HREF="e3-13.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A><P>



<A NAME="5.4"></A> <H3>Фазовая коррекция</H3>

<P ALIGN="JUSTIFY">Фактическое FT будет использовать вход, состоящий из ДЕЙСТВИТЕЛЬНОЙ и МНИМОЙ части.
Вы можете думать о M<FONT SIZE="-1"><SUB>x</SUB></FONT> как о ДЕЙСТВИТЕЛЬНОМ входе, а о M<FONT SIZE="-1"><SUB>y</SUB></FONT> как о МНИМОМ входе. Результирующий выход ПФ, таким образом, также будет иметь ДЕЙСТВИТЕЛЬНЫЙ и МНИМЫЙ компонент.</P>

Рассмотрим следующую функцию: <P>
<CENTER>
f(t) = e<SUP>-at</SUP> e<SUP>-i2<FONT FACE="Symbol">p</FONT><FONT FACE="Symbol">n</FONT>t</SUP>
<A HREF="e4-1.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A></CENTER><P>

<P ALIGN="JUSTIFY">В спектроскопии ЯМР FT реальный выход FT принимается как спектр частотной области. Чтобы увидеть эстетически приятный (поглощающий) спектр частотной области, мы хотим ввести функцию косинуса в действительную часть и функцию синуса в мнимые части ПФ. Вот что происходит, если часть косинуса вводится как мнимая, а синус как действительная.
<A HREF="e4-2.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A></P>

<P ALIGN="JUSTIFY">В идеальном эксперименте ЯМР все частотные компоненты, содержащиеся в записанном ЗСИ, не имеют фазового сдвига. На практике во время реального эксперимента ЯМР необходимо применить фазовую коррекцию к спектрам либо временной, либо частотной области, чтобы получить спектр поглощения как реальный выходной сигнал ПФ. Этот процесс эквивалентен преобразованию координат, описанному в
<A HREF="../chap-2/chap-2.html#2.6" TARGET="TEXT">Главе 2</A>
</P>

<CENTER>
<IMG SRC="images/cord-mat.gif">
</CENTER>

<P ALIGN="JUSTIFY">Если вышеупомянутый ЗСИ записан таким образом, что в действительном и мнимом ЗСИ имеется сдвиг фаз 45<FONT SIZE="-1"><SUP>o</SUP></FONT>,
<A HREF="e4-3.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A> 
матрицу преобразования координат можно использовать с
<IMG SRC="../images/12-phi.gif"> = - 45<FONT SIZE="-1"><SUP>o</SUP></FONT>.
Скорректированные ЗСИ выглядят как функция косинуса в действительной части и синуса в мнимой части.
<A HREF="e4-4.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A></P>

<P ALIGN="JUSTIFY">Преобразование Фурье скорректированных по фазе ЗСИ дает спектр поглощения для реального выходного сигнала ПФ.
<A HREF="e4-1.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>


</P>

<P ALIGN="JUSTIFY">Фазовый сдвиг также изменяется в зависимости от частоты, поэтому спектры ЯМР требуют как постоянных, так и линейных поправок к фазировке преобразованного Фурье сигнала.<P>
<CENTER>
<IMG SRC="../images/12-phi.gif"> = m <FONT FACE="Symbol">n</FONT> + b
</CENTER></P>

<P ALIGN="JUSTIFY">Постоянные фазовые коррекции, b, возникают из-за неспособности спектрометра обнаружить точные
M<FONT SIZE="-1"><SUB>x</SUB></FONT> и M<FONT SIZE="-1"><SUB>y</SUB></FONT>.
Линейные фазовые коррекции, m, возникают из-за неспособности спектрометра обнаружить поперечную намагниченность, начинающуюся сразу после РЧ-импульса. Следующий рисунок изображает большую потерю фазы в высокочастотном ЗСИ, когда теряется начальный желтый участок.
  
<A HREF="e4-5.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>


С практической точки зрения фазовая коррекция применяется в частотной области, а не во временной, поскольку мы знаем, что реальный спектр частотной области должен состоять из всех положительных пиков. Поэтому мы можем корректировать b и m до тех пор, пока все положительные пики не будут видны в реальном выходе преобразования Фурье.</P>




В магнитном резонансе отображаются сигналы M<FONT SIZE="-1"><SUB>x</SUB></FONT> или M<FONT SIZE="-1"><SUB>y</SUB></FONT>. В некоторых приложениях иногда может использоваться сигнал амплитуды.
Сигнал амплитуды равен квадратному корню из суммы квадратов
M<FONT SIZE="-1"><SUB>x</SUB></FONT> и M<FONT SIZE="-1"><SUB>y</SUB></FONT>. <P>





<A NAME="5.6"></A> <H3>Пары Фурье</H3>

To  better understand FT NMR  functions, you need to know some common  Fourier pairs. 
<A HREF="../refs/ref-04.html" TARGET="ANIMATION"><IMG SRC="../images/ref.gif"></A>  
<A HREF="../refs/ref-13.html" TARGET="ANIMATION"><IMG SRC="../images/ref.gif"></A>  
Чтобы лучше понять функции ЯМР ПФ, вам нужно знать некоторые общие пары Фурье. Пара Фурье — это две функции, форма частотной области и соответствующая форма временной области. Вот несколько пар Фурье, которые полезны в ЯМР. Амплитуда пар Фурье была проигнорирована, поскольку она не имеет значения в ЯМР.
<P>

<A HREF="e6-1.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>
Постоянное значение во все времена<P>

<A HREF="e6-2.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>

Действительная часть: cos(2<IMG SRC="../images/10-pi.gif"><IMG SRC="../images/10-nu.gif">t),
Мнимая часть: -sin(2<IMG SRC="../images/10-pi.gif"><IMG SRC="../images/10-nu.gif">t)<P>

<A HREF="e6-3.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>
Функция гребенки (серия дельта-функций, разделенных символом T.)<P>

<A HREF="e6-4.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>
Экспоненциальный спад: e<SUP>-at</SUP> для t > 0.<P>

<A HREF="e6-5.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>
Прямоугольный импульс, начинающийся с 0 и длительностью T секунд.<P>


<A HREF="e6-6.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>
Гаусса: exp(-at<FONT SIZE="-1"><SUP>2</SUP></FONT>)<P>


<A NAME="5.7"></A> <H3>Теорема о свертке</H3>

Для ученого, изучающего магнитный резонанс, самой важной теоремой, касающейся преобразований Фурье, является теорема о свертке. Теорема о свертке гласит, что преобразование Фурье свертки двух функций пропорционально произведениям отдельных преобразований Фурье, и наоборот.
<A HREF="../refs/ref-03.html#[3]" TARGET="ANIMATION"><IMG SRC="../images/ref.gif"></A>
<A HREF="../refs/ref-13.html#[13]" TARGET="ANIMATION"><IMG SRC="../images/ref.gif"></A> 
<P>

Если f(<IMG SRC="../images/10-omega.gif">) = FT( f(t) ) и
g(<IMG SRC="../images/10-omega.gif">) = FT( g(t) )<P>

тогда f(<IMG SRC="../images/10-omega.gif">) g(<IMG SRC="../images/10-omega.gif">)
= FT( g(t) <IMG SRC="../images/10-convl.gif"> f(t) ) и
f(<IMG SRC="../images/10-omega.gif">) <IMG SRC="../images/10-convl.gif">
 g(<IMG SRC="../images/10-omega.gif">) = FT( g(t) f(t) )<P>

Это будет легче увидеть на картинках. В окне анимации мы пытаемся найти FT синусоиды, которая включается и выключается.
<A HREF="f5-2.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>
Теорема о свертке говорит нам, что это функция sinc на частоте синусоиды.<P>

Другое применение теоремы о свертке — шумоподавление. С помощью теоремы о свертке можно увидеть, что свертка спектра ЯМР с функцией Лоренца совпадает с преобразованием Фурье умножения сигнала временной области на экспоненциально затухающую функцию.
<A HREF="e5-1.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>  <P>


<A NAME="5.8"></A> <H3>Цифровое ПФ</H3>
В спектрометре ядерного магнитного резонанса компьютер видит не непрерывный ЗСИ, а ЗСИ, который дискретизируется с постоянным интервалом. Каждая точка данных, составляющая ЗСИ, будет иметь дискретные значения амплитуды и времени. Поэтому компьютеру необходимо взять ПФ ряда дельта-функций, которые различаются по интенсивности.

<A HREF="e8-1.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A><P>

Что такое ПФ сигнала, представленного этой серией дельта-функций? Ответ будет дан в следующем заголовке, но сначала некоторая информация о взаимосвязях между выборочными данными временной области и результирующим спектром частотной области. Спектр временной области из n точек выбирается в <FONT FACE="Symbol">d</FONT>t и требует времени t для записи.
<A HREF="e8-2.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>
Соответствующий комплексный спектр частотной области, который создает дискретное FT, имеет n точек, ширину f и разрешение <FONT FACE="Symbol">d</FONT>f. Соотношения между величинами следующие.<P>

<CENTER>
 f = (1/<FONT FACE="Symbol">d</FONT>t)<P>
<FONT FACE="Symbol">d</FONT>f = (1/t)
</CENTER><P>

 



<A NAME="5.9"></A> <H3>Ошибка выборки</H3>
Проблема или артефакт обертывания в спектре ядерного магнитного резонанса — это появление одной стороны спектра на противоположной стороне. В терминах одномерного спектра частотной области обертывание — это возникновение низкочастотного пика, который происходит на высокочастотной стороне спектра. <P>

Теорема о свертке может объяснить, почему эта проблема возникает из-за выборки поперечной намагниченности со слишком низкой скоростью. Сначала посмотрите, как выглядит ПФ правильно выбранного ЗСИ.
<A HREF="e9-1.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>

При квадратурном детектировании спектральная ширина равна обратной частоте выборки или ширине зеленого поля в окне анимации. <P>

Если частота дискретизации меньше ширины спектра, происходит циклический скачок.
<A HREF="e9-2.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A><P>

<A NAME="5.10"></A> <H3>Двумерное ПФ</H3>

Двумерное преобразование Фурье (2-ДПФ)
<A HREF="../refs/ref-16.html" TARGET="ANIMATION"><IMG SRC="../images/ref.gif"></A>
— это преобразование Фурье, выполняемое над двумерным массивом данных.<P>

Рассмотрим двумерный массив данных, изображенный в окне анимации.
<A HREF="e10-1.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A>
Эти данные имеют измерения t' и t". Сначала выполняется преобразование Фурье для данных в одном измерении, а затем во втором. Первый набор преобразований Фурье выполняется в измерении t' для получения набора данных размером f' на t".
<A HREF="e10-2.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A> 

Второй набор преобразований Фурье выполняется в измерении t" для получения набора данных размером f' на f".
<A HREF="e10-3.html" TARGET="ANIMATION"><IMG SRC="../images/start.gif"></A><P>

2-DFT требуется для выполнения современной МРТ. В МРТ данные собираются в эквиваленте измерений t' и t", называемом k-пространством. Эти необработанные данные преобразуются Фурье для получения изображения, которое является эквивалентом данных f' на f", описанных выше.<P>


<HR COLOR="#CC0000">

<H5>
<CENTER>

Переход к: [
    <A HREF="../chap-4/chap-4.html">Предыдущая глава</A> |
    <A HREF="#top">Начало главы</A> |
    <A HREF="../chap-6/chap-6.html">Следующая глава</A> |
    <A HREF="../bnmr.html" TARGET="NEW">Обложка</A> ]<P>

Авторские права © 1997-2017 JP Hornak. <BR>
Все права защищены.

</CENTER>
</H5>
</BODY>

<!-- Mirrored from www.cis.rit.edu/htbooks/nmr/chap-5/chap-5.htm by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Jun 2021 07:45:11 GMT -->
</HTML>

